apiVersion: "nuclio.io/v1"
kind: NuclioFunction
metadata:
  name: onnx_test
spec:
  handler: main:handler
  runtime: python:3.6
  minReplicas: 1
  maxReplicas: 1
  description: Run an onnx model
  image: onnx_test:latest
  triggers:
    default-http:
      class: ""
      kind: http
      name: default-http
      maxWorkers: 1
      attributes:
        port: 32002
  resources:
    limits:
      nvidia.com/gpu: 1
  build:
    commands:
      - pip3 install tensorflow onnxruntime-gpu

# nuctl deploy execute_command --run-image execute_command:latest --runtime python:3.6 --handler main:handler --platform local --resource-limit nvidia.com/gpu=1